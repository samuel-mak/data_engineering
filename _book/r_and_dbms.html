<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data Engineering - Working with DBMS using R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./odbc.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="quarto_books_style_1.css">
</head>

<body class="nav-sidebar floating fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./r_and_dbms.html"><span class="chapter-title">Working with DBMS using R</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Engineering</a> 
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">The basic data engineering shits to know as analysts in an organisation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./s4.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./odbc.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Working with DBMS</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_and_dbms.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Working with DBMS using R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Working with DBMS using R</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">May 19, 2024</p>
    </div>
  </div>
    
  </div>
  

</header>

<p><strong>Introduction</strong></p>
<ul>
<li>Various DBMSs can be worked with using R</li>
<li>The specific way that this is done differ between the DBMSs and operating system</li>
</ul>
<p><strong>Working with ODBC-compliant DBMS from ODBC-compliant applications</strong></p>
<ul>
<li><strong>The General Process</strong>
<ul>
<li>ODBC-compliant DBMSs and applications are those that adhere to ODBC standards thus can be connected through ODBC</li>
<li>ODBC-compliant DBMSs include Microsoft SQL Server, Microsoft Access, and MySQL, ODBC-compliant applications include R, Python, Excel, and SPSS</li>
<li>Working with an ODBC-compliant DBMS from an ODBC-compliant application necessarily involves, in addition to the application and the DBMS, an ODBC interface, an ODBC manager, and a DBMS-specific ODBC driver, all for mediating the connection between the application and the DBMS.</li>
<li>Upon a request being called by the application, the application sends the application-specific call to the ODBC interface, the ODBC interface translates the application-specific calls from the application to an ODBC call, which is a call adhering to the ODBC standards, through its ODBC functions, it then establishes a connection with and sends the ODBC call to the DBMS-specific ODBC driver either directly or indirectly through the ODBC manager, which manages one or more DBMS-specific ODBC drivers.</li>
<li>The DBMS-specific ODBC driver translates the ODBC call to a DBMS-specific call (which may involve DBMS-specific SQL), it then establishes a connection to and sends the DBMS-specific call to the DBMS (e.g.&nbsp;its server/engine) where the call is executed.</li>
<li>If the call involves extracting information from the DBMS, the DBMS sends the information to its DBMS-specific ODBC driver, the DBMS-specific ODBC driver fetches the information from the DBMS, translates it to an ODBC information, and sends it to the ODBC interface, the ODBC interface fetches the ODBC information from the DBMS-specific driver and may further process it (e.g.&nbsp;translation) if there is an upper layer (e.g.&nbsp;application).</li>
</ul></li>
<li><strong>General Steps</strong>
<ol type="1">
<li><strong>Make sure an ODBC manager is ready for use</strong>
<ul>
<li>ODBC managers are usually an individual software/programme that are specific to an operating system, hence, they should be considered with regards to specific operating systems:
<ul>
<li><strong>Windows OS</strong>
<ul>
<li>Windows OS comes with an ODBC manager in the form of a system application called “ODBC Data Source Administrator”.</li>
</ul></li>
<li><strong>MacOS</strong>
<ul>
<li>MacOs used to come with an ODBC manager in form of system application called “ODBC Administrator” until Mac OS “Snow Leopard” from which ODBC managers for MacOS are downloaded from external developers. ODBC managers for MacOS include:
<ul>
<li><strong>ODBC Manager</strong>
<ul>
<li>ODBC Manager is free proprietary ODBC manager developed by Actual Technologies</li>
<li>Go to <a href="https://odbcmanager.net/" target="_blank"> ODBC Manger </a> to learn more or download</li>
</ul></li>
<li><strong>Independent ODBC (iODBC) for MacOS</strong>
<ul>
<li>iODBC is both an open-source initiative initiated and managed by OpenLink Software that encourages the open-source development of ODBC managers for various Linux or Unix-based OS (incl.&nbsp;MacOS) and the ODBC managers under this initiative</li>
<li>Go to <a href="https://www.iodbc.org/dataspace/doc/iodbc/wiki/iodbcWiki/WelcomeVisitors" target="_blank"> iODBC </a> to learn more about iODBC and to download</li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li><strong>Make sure an ODBC driver for the DBMS is ready for use</strong>
<ul>
<li>ODBC-specific ODBC drivers are usually an individual software/programme that is specific to a DBMS, hence, they should be considered with regards to the DBMS:
<ul>
<li><strong>Microsoft SQL Server</strong>
<ul>
<li><strong>ODBC Driver for SQL Server</strong>
<ul>
<li>Developed and distributed by Microsoft</li>
<li>Go to <a href="https://learn.microsoft.com/en-us/sql/connect/odbc/download-odbc-driver-for-sql-server?view=sql-server-ver16" target="_blank"> ODBC Driver for SQL Server </a> to learn more or download</li>
</ul></li>
</ul></li>
<li><strong>MySQL</strong>
<ul>
<li><strong>Connector/ODBC</strong>
<ul>
<li>Developed and distributed by MySQL</li>
<li>Go to <a href="https://dev.mysql.com/downloads/connector/odbc/" target="_blank"> MySQL </a> to download</li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li><strong>Make sure an ODBC interface is ready for use</strong>
<ul>
<li>ODBC interfaces are usually specific to the application and exist as either an in-built functionality of the application or an extension (e.g.&nbsp;packages/modules/plug-ins), hence, they should be considered with regards to the application:
<ul>
<li><strong>R</strong>
<ul>
<li>ODBC interfaces for R are in the form of R packages (aka ODBC interface R packages) with specific operations handled by specific functions. There are multiple ODBC interface R packages that are independently capable of working with an ODBC-compliant DBMS. The main ODBC interface R packages are:
<ul>
<li><strong>DBI</strong>
<ul>
<li>An R package in CRAN developed by R Special Interest Group on Databases (R-SIG-DB) and Hadley Wickham and maintained by Kirill Müller</li>
<li>Install/update the DBI package from CRAN by running the R command if it hasn’t been installed/needs to be updated</li>
<li><details>
<summary>
Installation guidance
</summary>
<ul>
<li><p>Install the package <code>DBI</code> by running the following R codes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.package</span>(<span class="st">"DBI"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>You can access whether the package <code>DBI</code> is installed in R by running the following R codes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="st">"DBI"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>The version of the installed <code>DBI</code> package can be accessed by running the following R codes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">packageVersion</span>(<span class="st">"DBI"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] '1.2.2'</code></pre>
</div>
</div></li>
</ul></details></li>
</ul>

<ul>
<li>See package documentation by running <code>RShowDoc(what = "DBI", package = "DBI")</code></li>
</ul></li>
<li><strong>RODBC</strong>
<ul>
<li>An R package developed by Brian Ripley and Michael Lapsley and maintained by Brian Ripley</li>
<li>Install/update the RODBC package from CRAN by running the R command if it hasn’t been installed/needs to be updated</li>
<li><details>
<summary>
Installation guidance
</summary>
<ul>
<li><p>Install the package <code>DBI</code> by running the following R codes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.package</span>(<span class="st">"DBI"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>It has been reported that the above method may not work for MacOS (e.g.&nbsp;<a href="https://stackoverflow.com/questions/43804850/how-to-install-rodbc-on-macos-sierra-10-12-4" target="_blank"> here on Stack Overflow </a>)</p></li>
<li><details>
<summary>
<p>Alternative method for MacOS</p>
</summary>
<ul>
<li>Any CRAN packages can be installed in the terminal</li>
<li>Install the Homebrew package if it hasn’t been installed by running the following Bash commands in the terminal
<ul>
<li><code>/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"</code></li>
</ul></li>
<li>Install wget using Homebrew if it hasn’t been installed by running the following brew command line utility codes in the terminal
<ul>
<li><code>brew install wget</code></li>
</ul></li>
<li>Download the package tar.gz file from CRAN to the Shell directory by running the following wget command-line interface codes in the terminal
<ul>
<li><code>wget "http://cran.r-project.org/src/contrib/tar_filename.tar.gz"</code></li>
</ul></li>
<li>Install the package to R by running the following R command-line interface codes in the terminal
<ul>
<li><code>R CMD INSTALL tar_filename.tar.gz</code>
<ul>
<li><strong><em>Where</em></strong>
<ul>
<li><code>tar_filename</code> is the name of the tar.gz file of the package on CRAN, which can change, especially with the version of the package. The name of the tar.gz file for the latest version an R package on CRAN can be found on CRAN <a href="http://cran.r-project.org/src/contrib/" target="_blank">here</a></li>
</ul></li>
</ul></li>
</ul></li>
<li>Remove the initially downloaded tar.gz file by running the following bash commands in the terminal
<ul>
<li><code>rm tar_filename.tar.gz</code>
<ul>
<li><strong><em>Where</em></strong>
<ul>
<li><code>tar_filename</code> is the name of the tar.gz file of the package initially downloaded from CRAN</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</details></li>
<li><p>You can access whether the package <code>DBI</code> is installed in R by running the following R codes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="st">"DBI"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>The version of the installed <code>DBI</code> package can be accessed by running the following R codes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">packageVersion</span>(<span class="st">"DBI"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ul>
</details></li>
<li>See package documentation by running <code>RShowDoc(what = "RODBC", package = "RODBC")</code></li>
</ul></li>
</ul></li>
<li><strong>Comparison</strong>
<ul>
<li>Both <code>DBI</code> and <code>RODBC</code> are independently capable, reliable, simple to use, and developed by great developers. However, <code>DBI</code> has more functionalities (e.g.&nbsp;error handling, integrative functionalities with RStudio, specifically, it usefully shows the structure of the connected DBMS engine/server with databases, tables and table columns and their data types in the “Connection” pane), covers more types of DBMSs (not just ODBC-compliant ones), and, in some cases/reportedly seems to be faster than <code>RODBC</code></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ol></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>?odbc<span class="sc">::</span>odbc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Working with an ODBC-compliant DBMS from R</strong></p>
<ul>
<li><strong>Introduction</strong>
<ul>
<li>As mentioned, ODBC-compliant DBMSs are worked with from R through an ODBC interface R package (e.g.&nbsp;<code>DBI</code> or <code>RODBC</code>) with specific operations handled by specific functions. The main operations are described for both <code>DBI</code> and <code>RODBC</code>.</li>
</ul></li>
<li><strong>Connect R to an ODBC-compliant DBMS</strong>
<ul>
<li><strong>DBI</strong>
<ul>
<li><p>The <code>dbConnect</code> function is a generic for connecting R to a DBMS</p></li>
<li><p>The <code>dbConnect</code> function has the general form and usage</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>connection_object_dbi <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(drv, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><strong><em>Where</em></strong>
<ul>
<li><code>drv</code> specifies the type of the DBMS to be connected to using a back-end function for calling an appropriate method for connecting R to the specific DBMS. For ODBC-compliant DBMSs, it would be the <code>odbc::odbc()</code> function.</li>
<li><code>...</code> is a set of argument(s) that depends on the back-end function to the <code>drv</code> argument (or the specific method being called), hence, refer to the back-end function for the specific set of arguments and details, these usually involve the DSN</li>
</ul></li>
</ul></li>
</ul></li>
<li><strong>RODBC</strong>
<ul>
<li><p>The <code>odbcDriverConnect</code> function connects R to an ODBC-compliant DBMS</p></li>
<li><p>The <code>odbcDriverConnect</code> function has the general form and usage</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>connection_object_rodbc <span class="ot">&lt;-</span> RODBC<span class="sc">::</span><span class="fu">odbcDriverConnect</span>(connection)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><strong><em>Where</em></strong>
<ul>
<li><code>connection</code> is the DSN (aka connection string). The format of a DSN is specific to the ODBC driver and/or ODBC-compliant DBMS. For example, the DSN for Microsoft SQL Server is “Driver={ODBC Driver 17 for SQL Server};Server={Server Name};Database={Database Name};”</li>
</ul></li>
<li><strong><em>Notes</em></strong>
<ul>
<li>The <code>RODBC</code> packages actually provides two ways of doing this, one that’s shown above, the other is through the <code>odbcConnect</code> function. The <code>odbcDriverConnect</code> method is preferred as the <code>odbcConnect</code> function is less flexible in that it requires the manual action of first setting up a DSN registry in the ODBC manager (e.g.&nbsp;ODBC Data Source Administrator application on Windows OS), which is done outside of R, while the <code>odbcDriverConnect</code> method doesn’t require this step, hence <code>odbcDriverConnect</code> has advantages in terms of automation and collaboration. Though, many people still use <code>odbcConnect</code> probably because they haven’t caught up with updates or even read package documentation at all or it not working for them.</li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li><strong>Sending request calls</strong>
<ul>
<li><strong>DBI</strong>
<ul>
<li><strong>Introduction</strong>
<ul>
<li>The <code>DBI</code> package provides a set of functions for sending different request calls to the DBMS/DBMS driver upon being called. These functions can be organised in a hierarchy where lower level functions are used to send relatively simple/basic request calls (usually in line with ODBC standard calls) while higher level functions are built on multiple lower level functions and possibly other functions for sending more complex/abstract request calls (usually specific to R). Some of these functions are described below.</li>
</ul></li>
<li><strong>Level 1 functions</strong>
<ul>
<li><code>dbSendQuery</code>
<ul>
<li><strong>Description</strong>
<ul>
<li>Send an SQL select statement to a specified DBMS for execution and returns an instance of class <code>DBIResult</code></li>
<li>This is recommended for simple SQL select statements, for more complex non-select data manipulation SQL statements, use <code>dbSendStatement</code> (see below)</li>
</ul></li>
<li><strong>Usage</strong>
<ul>
<li><code>dbSendQuery(conn, statement,...)</code>
<ul>
<li><strong><em>Where</em></strong>
<ul>
<li><code>conn</code> is a DBI connection object</li>
<li><code>statement</code> is a SQL select statement</li>
<li><code>...</code> a set of arguments and inputs specific/to be passed on to a method (refer to the method for these)</li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li><code>dbSendStatement</code>
<ul>
<li><strong>Description</strong>
<ul>
<li>Send an SQL statement to a specified DBMS for execution and returns an instance of class <code>DBIResult</code></li>
<li>This is recommended for non-select data manipulation SQL statements, for simple select SQL statements, use <code>dbSendQuery</code> (see above)</li>
</ul></li>
<li><strong>Usage</strong>
<ul>
<li><code>dbSendStatement(conn, statement,...)</code>
<ul>
<li><strong><em>Where</em></strong>
<ul>
<li><code>conn</code> is a DBI connection object</li>
<li><code>statement</code> is a SQL statement</li>
<li><code>...</code> a set of arguments and inputs specific/to be passed on to a method (refer to the method for these)</li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li><code>dbGetRowsAffected</code>
<ul>
<li><strong>Description</strong>
<ul>
<li>Takes an instance object of class <code>DBIResult</code> and returns the number of rows being affected due to a request call (e.g.&nbsp;by <code>dbSendQuery</code> or <code>dbSendStatement</code>)</li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>?dbSendStatement</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>No documentation for 'dbSendStatement' in specified packages and libraries:
you could try '??dbSendStatement'</code></pre>
</div>
</div>
<p>LEVEL 0 FUNCTIONS dbSendQuery - Send a statement to the DBMS for execution (recommended for select statements only) - Returns an instance of class DBIResult dbSendStatement - Send a statement to the DBMS for execution (any statements, though not recommened for select statements because it doesn’t fetch any results) - Returns an instance of class DBIResult dbGetRowsAffected - Takes a DBIResult object and returns the number of rows being affected due to that statement execution dbFetch - Fetch any results returned by the DBMS due to a statement execution and return them as a data.frame in R dbHasCompleted - Takes a DBIResult object and determines whether the statement execution in the DBMS has completed dbClearResult - Takes a DBIResult object and frees local and remote resources that have been used by a statement execution (this is a necessity after a statement execution - e.g.&nbsp;by dbSendQuery or dbSendStatement - even if no rows have been affected/fetched or it led to an error) dbQuoteIdentifier - Takes parameters and generates an SQL statement string in a safe way (e.g.&nbsp;ensure characters are escaped) to avoid SQL injection attacks dbListTables - Show tables in the connection</p>
<pre><code>  - **Low-level functions**
    - `dbExecute`

- The `DBI` package provides two methods, the "R environment method" in which request calls are coded in R in an R environment (e.g. R script, R console, R code chunk/block within an R Markdown or Quarto document) and the "SQL environment in an R environment method" in which request calls are coded in SQL in an SQL environment within an R environment (e.g. SQL code chunk/block in an R Markdown or Quarto document)
  - **R environment method**
    - The `dbGetQuery` function takes a DBI connection object (returned from `dbConnect`) and a request call in SQL, upon being called, it sends the request call to the DBMS (specified in the DBI connection object) where the request call is executed and fetch and return any results returned from the DBMS.

    ::: {.cell}
    
    :::


that's in an R environment (e.g. R script, R console, R code chunk/block within an R Markdown or a Quarto document) and the other that's in an SQL environment within an R environment (i.e. SQL code chunk/block within an R Markdown or a Quarto document)</code></pre>
<ul>
<li><strong>RODBC</strong></li>
</ul>
<p>DBIResult - An S4 Class for representing a statement execution, specifically, the results and state</p>
<p>LEVEL 1 FUNCTIONS sqlAppendTable - Takes parameters and a table from R in the form of a data.frame and call dbQuoteIdentifier to generate an SQL statement string for appending an existing table (automates the process of typing the SQL statement for appending a table) sqlCreateTable - Takes parameters and dbQuoteIdentifier to generate an SQL statement for creating a table in the DBMS given its parameters</p>
<p>LEVEL 2 FUNCTIONS</p>
<p>dbExecute - dbSendStatement, dbGetRowsAffected, dbClearResults dbGetQuery - dbSendQuery, dbFetch, then dbClearResult</p>
<p>LEVEL 3 FUNCTIONS dbReadTable - Takes parameters and calls dbQuoteIdentifier to generate an SQL select statement and dbGetQuery dbCreateTable - sqlCreateTable, dbExecute dbAppendTable - sqlAppendTable, dbExecute dbRemoveTable - Takes parameters and passes them to and calls dbQuoteIdentifier to generate an SQL statement for removing a table in the DBMS and dbExecute dbExistsTable - Takes parameters and passes them to and calls dbQuoteIdentifier to generate an SQL statement for checking if a table exists and pass the statement to dbExecute to execute</p>
<p>LEVEL FOUR FUNCTIONS dbWriteTable - A function for appending or overwriting an existing or non-existing table. For all cases, it first checks whether the specified table exists using dbExistsTable. For appending, if the table exists, it calls dbAppendTable to append the table, if the table doesn’t exist, it calls dbCreateTable to create the table first and then dbAppendTable to append (or push) the table. For overwriting, if the table exists, it calls dbRemoveTable to remove the existing table, then calls dbCreateTable to create the table, and then calls dbAppendTable to append (or push) the table; if the table doesn’t exist, it calls dbCreateTable to create the table, and then calls dbAppendTable to append (or push) the table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>?dbCreateTable</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>?dbWriteTable</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>?dbAppendTable</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>?sqlAppendTableTemplate</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>?dbRemoveTable</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">RShowDoc</span>(<span class="st">"DBI"</span>, <span class="at">package =</span> <span class="st">"DBI"</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>?DBI<span class="sc">::</span>dbExistsTable</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>??odbc<span class="sc">::</span>dbWriteTable</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>?DBI<span class="sc">::</span>dbReadTable</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>?DBI<span class="sc">::</span>dbListTables</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>sdbGetRowCountsomethig - Something - <strong><em>Notes</em></strong> - The “Driver” and “Server” parameters are required while the “Database” parameter is optional and can be specified downstream when specifying a request call to the DBMS</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="fu">paste</span>(<span class="st">"open -a 'Google Chrome' "</span>,<span class="st">"_book/index.html"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>For Windows, Windows comes with an ODBC manager, </code></pre>
<p>The ODBC interface is usually associated with the application, specifically, it is either a functionality of the application or an extension to the application (e.g.&nbsp;packages/modules/plug-ins). The ODBC-specific ODBC driver is usually a separate software associated with the DBMS The DBMS-specific ODBC driver is usually associated with the DBMS, - <strong>Some terms</strong> - <strong>DBMS</strong> - A system for managing data - Examples include Microsoft SQL Server, Microsoft Access, Oracle, MySQL, PostgreSQL, MariaDB, SQLite - <strong>Open Database Connectivity (ODBC)</strong> - An ODBC is a connection between a software/application (e.g.&nbsp;R, Python, SPSS, Excel) and a DBMS through an ODBC interface/system (a standardised connection) - <strong>ODBC-compliant DBMS</strong> - ODBC-compliant DBMSs are DBMSs that adheres to the ODBC standards to allow applications to access them through ODBC (a standardised way of doing so) - ODBC-compliant DBMSs include Microsoft SQL Server, Microsoft Access, MySQL, PostgreSQL, Oracle Database, IBM Db2, SQLite, MariaDB, Amazon Redshift, Google BigQuery, etc.</p>
<p><strong>Open Database Connectivity (ODBC)</strong></p>
<ul>
<li><strong>Concept</strong>
<ul>
<li>An ODBC is a connection between an software/application (e.g.&nbsp;R, Python, SPSS, Excel) and a DBMS</li>
</ul></li>
</ul>
<p><strong>ODBC interface</strong></p>
<ul>
<li><strong>Concept</strong>
<ul>
<li>An API that manages one or more ODBCs</li>
<li>Provides a standard and general set of calls/commands (via ODBC functions) for softwares/applications to ODBC compliant DBMS (e.g.&nbsp;executing an SQL script), this standarisation and generalisation enables an ODBC to be independent of applications</li>
<li>Developed by Microsoft in early 1990s</li>
</ul></li>
</ul>
<p><strong>ODBC driver</strong></p>
<ul>
<li><strong>Concept</strong>
<ul>
<li>An ODBC driver provides a connection between an ODBC interface and a DBMS</li>
<li>An ODBC interface connects to different ODBC drivers as different DBMSs operate differently thus have their own specific DBMS function calls</li>
<li>An ODBC driver translates ODBC function calls into DBMS-specific function calls and passes them to the specific DBMS</li>
<li>This enables an ODBC interface to be independent of DBMSs</li>
<li>E.g. The old SQL Server and the new ODBC for SQL Server (these are drivers, despite having the word “servers” in their names)</li>
</ul></li>
</ul>
<p><strong>DSN</strong> - A parametric data structure/format that contains information for an ODBC driver to connect to a specific part of a DBMS (e.g.&nbsp;server/engine/database/table) - DSNs are ODBC driver-specific, but they tend to be simple and short with common parameters - Parameters of the DSN for an ODBC driver includes the name of the engine, name of the server, name of the database, name of the table, username and password for access</p>
<p><strong>Windows</strong> - <strong>In general</strong> - - ODBC Interface (API) - ODBC Drivers</p>
<ul>
<li></li>
<li><p>ODBC Data Source Administrator</p></li>
<li><p>ODBC Manager</p></li>
<li><p>ODBC driver</p></li>
<li></li>
<li><p>Set up a connection between the ODBC interface and the database</p></li>
<li><p>ODBC driver (install)</p></li>
<li><p>The ODBC Data Source Administrator (64-bit)</p></li>
<li><p>Set up a connection between R and the ODBC interface</p></li>
<li><p>R</p></li>
</ul>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./odbc.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Working with DBMS</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>